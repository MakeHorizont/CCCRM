# Спецификация API: Обслуживание и Ремонты (Maintenance Domain)

## Общие сведения
Модуль отвечает за поддержание средств производства в рабочем состоянии.
Принцип: **"Профилактика лучше лечения"**.

**Base URL:** `/maintenance`

---

## 1. Обслуживание Оборудования

### 1.1 Проведение обслуживания (Perform Maintenance)
**Эндпоинт:** `POST /equipment/:id/records`

Регистрирует факт проведения ТО или ремонта.

**Request Body:**
```json
{
  "type": "ROUTINE", // 'ROUTINE' (ТО), 'REPAIR' (Ремонт), 'INSPECTION' (Осмотр)
  "date": "2025-10-27",
  "description": "Замена масла и фильтров",
  "cost": 5000,
  "technician": "Иванов И.И.",
  "nextMaintenanceDate": "2025-11-27" // Опционально, иначе рассчитывается автоматически по интервалу
}
```

**Логика Бэкенда:**
1.  Создает запись в истории (`maintenanceHistory`).
2.  Обновляет статус оборудования:
    *   Если был `BROKEN` и тип `REPAIR` -> становится `OPERATIONAL`.
    *   Если был `MAINTENANCE` -> становится `OPERATIONAL`.
3.  Обновляет `nextMaintenanceDate`.
4.  Создает транзакцию расхода в Финансах (если `cost > 0`).

### 1.2 История обслуживания
**Эндпоинт:** `GET /equipment/:id/records`

Возвращает список всех записей.

---

## 2. Планирование (Scheduler)

### 2.1 График ППР
**Эндпоинт:** `GET /schedule`

Возвращает список оборудования, требующего обслуживания в ближайшее время.

**Query:** `days=30` (на сколько дней вперед смотреть)

**Response:**
```json
[
  {
    "equipmentId": "eq-1",
    "equipmentName": "Станок ЧПУ",
    "nextMaintenanceDate": "2025-10-30",
    "daysUntilDue": 3
  }
]
```